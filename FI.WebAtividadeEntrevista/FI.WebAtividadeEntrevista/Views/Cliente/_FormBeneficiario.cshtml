@model WebAtividadeEntrevista.Models.ClienteModel

@{ViewData["Title"] = "Incluir/Alterar Beneficiário";
}

<div class="modal-header">
    <h4 class="modal-title">@ViewData["Title"]</h4>
    <button type="button" class="close" data-dismiss="modal">
        <span aria-hidden="true">x </span><span class="sr-only">Fechar</span>
    </button>
</div>
<br />
<br />
@using (Html.BeginForm("IncluirBeneficiario", "Cliente", FormMethod.Post, new { id = "beneficiarioForm" }))
{
    @Html.AntiForgeryToken()
    <div class="form-horizontal">

        @Html.HiddenFor(model => model.Beneficiario.IdCliente)
        @Html.HiddenFor(model => model.Beneficiario.Id)

        <div class="modal-footer" style="border-top: 0">
                @Html.LabelFor(model => model.Beneficiario.Cpf, htmlAttributes: new { @class = "control-label col-md-1" })
                <div class="col-md-4">
                    @Html.EditorFor(model => model.Beneficiario.Cpf, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Cpf, "", new { @class = "text-danger" })
                </div>
                @Html.LabelFor(model => model.Beneficiario.Nome, htmlAttributes: new { @class = "control-label col-md-1" })
                <div class="col-md-4">
                    @Html.EditorFor(model => model.Beneficiario.Nome, new { htmlAttributes = new { @class = "form-control" } })
                    @Html.ValidationMessageFor(model => model.Nome, "", new { @class = "text-danger" })
                </div>
                <input type="submit" value="Incluir" class="btn btn-success" />
        </div>
    </div>
}
<div id="BeneficiariosTarget">
    @Html.Partial("_Beneficiarios")
</div>

@section Scripts{
    @Scripts.Render("~/bundles/jqueryval")
    <script>
        $(document).ready(function () {
            SetModal();
        })
    </script>
}
<script>

    //$(document).ready(function () {
    //    $('#beneficiarioForm').submit(function (event) {
    //        event.preventDefault();

    //        var beneficiario = {
    //            IdCliente: $('#Beneficiario_IdCliente').val(),
    //            Id: $('#Beneficiario_Id').val(),
    //            Nome: $('#Beneficiario_Nome').val(),
    //            CPF: $('#Beneficiario_CPF').val()
    //        };

    //        addBeneficiarioToList(beneficiario);

    //        //$('#myModal').modal('hide');
    //        limparCamposFormulario();
    //    });
    //});

    function addBeneficiarioToList(beneficiario) {
        var newRow = '<tr>' +
            '<td>' + beneficiario.Nome + '</td>' +
            '<td>' + beneficiario.CPF + '</td>' +
            '</tr>';

        $('#beneficiariosTable tbody').append(newRow);
    }

    function limparCamposFormulario() {
        $('#Beneficiario_Nome').val('');
        $('#Beneficiario_CPF').val('');
        console.log("Campos do formulário limpos.");
    }
</script>
